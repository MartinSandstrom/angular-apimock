/*! Angular API Mock v0.1.8
 * Licensed with MIT
 * Made with â™¥ from Seriema + Redhorn */
angular.module("apiMock",[]).config(["$httpProvider",function(a){a.interceptors.push("httpInterceptor")}]).provider("apiMock",function(){function a(a){var c=[];a=b(a);for(var d in a)if(a.hasOwnProperty(d)){var e=encodeURIComponent(a[d]);"string"==typeof e&&(e=e.toLowerCase()),c.push(encodeURIComponent(d)+"="+e)}return c.join("&")}function b(a){var b,c={},d=[];for(b in a)a.hasOwnProperty(b)&&d.push(b);for(d.sort(),b=0;b<d.length;b++)c[d[b]]=a[d[b]];return c}function c(a){var b,c=/apimock/i;return angular.forEach(a,function(a,d){c.test(d)&&(b=a)}),b}function d(a){return c(a)}function e(a){var b=d(a);return void 0===b&&(b=g()),b}function f(a){switch(typeof a){case"number":if(0!==a&&!isNaN(a))return{type:"respond",value:a};break;case"string":switch(a.toLowerCase()){case"auto":return{type:"recover"};case"true":return{type:"reroute"}}break;case"boolean":if(a===!0)return{type:"reroute"}}return{type:"ignore"}}function g(){return c(n.search())}function h(a){var b={status:a,headers:{"Content-Type":"text/html; charset=utf-8",Server:"Angular ApiMock"}};return o.info("apiMock: mocking HTTP status to "+a),p.reject(b)}function i(a){return 0===a.indexOf(q.apiPath)}function j(a){i(a.url)&&r.push(a)}function k(a){var b=!1;return angular.forEach(r,function(c,d){c.method===a.method&&c.url===a.url&&(b=!0,r.splice(d,1))}),b}function l(b){var c;if(!i(b.url))return b;var d=b.url,e=b.url.substring(q.apiPath.length);return e=q.mockDataPath+e,q.stripQueries?(c=/[a-zA-z0-9/.\-]*/,e=c.exec(e)[0]):(e=e.replace(/\?/,"/"),e=e.replace(/\/\//,"/"),c=/[a-zA-z0-9=&/.\-]*/,e=c.exec(e)[0],"object"==typeof b.params&&("/"!==e.substring(e.length-1)&&(e+="/"),e+=a(b.params))),b.params=void 0,"/"===e[e.length-1]&&(e=e.slice(0,-1)),e+="."+b.method.toLowerCase()+".json",b.method="GET",b.url=e,o.info("apiMock: rerouting "+d+" to "+e),b}function m(a,b,c){n=a,o=b,p=c}var n,o,p,q={mockDataPath:"/mock_data",apiPath:"/api",disable:!1,stripQueries:!0},r=[],s=m.prototype;s._countFallbacks=function(){return r.length},s.onRequest=function(a){if(q.disable)return a;var b=e(a),c=f(b);switch(c.type){case"reroute":return l(a);case"recover":return j(a),a;case"respond":return h(c.value);case"ignore":return a;default:return a}},s.onResponse=function(a){return q.disable?a:(k(a),a)},s.recover=function(a){return q.disable?!1:void 0===a.config?!1:k(a.config)?(o.info("apiMock: recovering from failure at "+a.config.url),l(a.config)):!1},this.config=function(a){angular.extend(q,a)},this.$get=["$location","$log","$q",function(a,b,c){return new m(a,b,c)}]}).service("httpInterceptor",["$injector","$q","apiMock",function(a,b,c){this.request=function(a){return a=c.onRequest(a),a||b.when(a)},this.response=function(a){return a=c.onResponse(a),a||b.when(a)},this.responseError=function(d){var e=c.recover(d);if(e){var f=a.get("$http");return f(e)}return b.reject(d)}}]);